#############################################
# DeepRubric Monorepo â€“ Production pnpm Configuration
# Enterprise-grade, secure, and optimized for CI/CD
#############################################

##########
# Security & Safety
##########

# Enforce correct peer dependencies
# Prevents silent React / ESLint mismatches
strict-peer-dependencies=true

# Do NOT auto-install peer deps
# Forces explicit, intentional dependency choices
auto-install-peers=false

# Verify package integrity
package-import-method=auto

# Strict engine checks
engine-strict=true

# Audit dependencies for vulnerabilities
audit=true

##########
# Workspace Behavior
##########

# Use a single lockfile for the entire monorepo
shared-workspace-lockfile=true

# Prefer workspace packages over registry versions
link-workspace-packages=hardlink

# Enable workspace protocol
public-hoist-pattern[]=*

##########
# Performance & Optimization
##########

# Prefer local cache when possible
prefer-offline=true

# Use hoisted linker for monorepo efficiency
node-linker=hoisted

# Enable parallel installation
network-concurrency=16

# Use fast fetch
fetch-retry-mintimeout=2000
fetch-retry-maxtimeout=10000

# Cache settings
cache-max=10000
store-max-age=7

##########
# Determinism & Reproducible Builds
##########

# Always respect the lockfile in CI
frozen-lockfile=false

# Save exact versions (no ^ or ~)
save-prefix='='

# Use strict semver
save-exact=true

# Enable integrity checks
verify-store-integrity=true

##########
# CI/CD & Production
##########

# Disable interactive prompts in CI
color=true
progress=true

# Reduce noise in CI logs
loglevel=warn

# Enable summary reporting
reporter=append-only

# Network resilience
fetch-retries=3
fetch-retry-factor=2

##########
# Node / Tooling Consistency
##########

# Prevent accidental global installs
global-dir=~/.pnpm-global

# Use consistent package manager
package-manager-client=pnpm

# Enable patch support
patch-file-supported=true

##########
# Development Experience
##########

# Enable hooks
enable-pre-post-install-hooks=true

# Use modern features
node-options=--max-old-space-size=4096

# Enable workspace protocol
protocol-strict-ssl=true
